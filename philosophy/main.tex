% !TeX spellcheck = en_US
% !TeX program = xelatex

\documentclass[a4paper,14pt]{extarticle}
\renewcommand{\baselinestretch}{1.1}
\usepackage[utf8]{inputenc}
\usepackage[T2A, T1]{fontenc}
\usepackage[english, russian]{babel}

\usepackage{fontspec}
\setmainfont{Times New Roman}
\usepackage{setspace, amsmath}
\usepackage{amssymb}
\usepackage{dsfont}
\usepackage{epsfig}
\usepackage{pdfpages}

\makeatletter
\let\@fnsymbol\@arabic
\makeatother

\usepackage{geometry}
\geometry{
a4paper,
total={194mm, 257mm},
left=8mm,
top=20mm,
}

\usepackage{systeme}
\usepackage{skak}
\usepackage{mathtools}
\usepackage{unicode-math}
\usepackage{array}
\usepackage{makecell}
\usepackage{subfiles}
\usepackage{hyperref}
\hypersetup{pdfstartview=FitH, linkcolor=black, urlcolor=blue, colorlinks=true}
\usepackage{framed}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{color}
\usepackage{chngcntr}
\usepackage{tikz}
\usepackage{csquotes}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{comment}
\usepackage{adjustbox}
\usepackage[breakable, skins]{tcolorbox}

\usepackage{accsupp}
\DeclareRobustCommand\notselectableinacrobat[1]{%
    \BeginAccSupp{method=plain,ActualText={}}#1\EndAccSupp{}}

\makeatletter
\newcommand{\pagetarget}[2]% #1=label (both hypertarget and label), #2=text
{\hypertarget{#1}{#2}\protected@write\@auxout{}{%
   \string\newlabel{#1}{{#2}{\thepage}{page.\thepage}{#1}{}}}}
\makeatother

\newcommand{\pagelink}[2]% #1=label, #2=text
{\hyperlink{\getrefbykeydefault{#1}{name}{Doc-Start}}{#2}}

\usepackage{eso-pic, rotating, graphicx}
\definecolor{mygray}{gray}{0.5}
\definecolor{mygray2}{gray}{0.4}

\fancypagestyle{plain}{%
	\fancyhf{}%
	\fancyhead[L]{\phantom{}\notselectableinacrobat{\pagelink{doc:\thesection}{\leftmark}}}%
	%\fancyhead[R]{\phantom{}\notselectableinacrobat{\hyperlink{tocsection.\thesection}{\textcolor{mygray2}{Вернуться к содержанию}}}}%
	%\fancyhead[L]{\leftmark \\ \rightmark}
	%\fancyhead[R]{\thepage}
	%\fancyhead[R]{\rightmark}
	\fancyfoot[C]{\phantom{}\notselectableinacrobat{\hyperlink{tocsubsection.\thesubsection}{\thepage}}}
	%\fancyfoot[L]{\rightmark}
}
\pagestyle{plain}

\usepackage{float}
\floatstyle{plaintop}
\usepackage{enumitem}
\usepackage{indentfirst}
\setlength{\parindent}{25pt}
\usepackage{enumitem}
\setlist[itemize]{noitemsep}
%\setcounter{section}{-1}

\graphicspath{{./img/}}
\newcommand{\myPictWidth}{.95\textwidth}
\newcommand{\phm}{\phantom{-}}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}

\newenvironment{nohyphen}
  {\tolerance=1
   \emergencystretch=\maxdimen
   \hyphenpenalty=10000
   \hbadness=10000}
  {\par}

\newcommand{\insertlectureslide}[3][1]{{\parindent0pt\includegraphics[width=\textwidth, page=#2]{lecture#3.pdf}}\ifnum#1=1 \newpage \else \fi}

\let\oldcontentsline\contentsline%
\renewcommand\contentsline[4]{%
\hypertarget{toc#4}{}%
\oldcontentsline{#1}{#2}{#3}{#4}}

\newcommand{\linksection}[2][\DefaultOpt]{\def\DefaultOpt{#2}\section[#1]{\protect\hyperlink{tocsection.\thesection}{#2}\pagetarget{doc:\thesection}}
\addtocontents{toc}{\protect\pagetarget{sec:\thesection}{}}}

\newcommand{\sublinksection}[2][\DefaultOpt]{\def\DefaultOpt{#2}\subsection[#1]{\protect\hyperlink{tocsubsection.\thesubsection}{#2}\pagetarget{doc:\thesubsection}}
\addtocontents{toc}{\protect\pagetarget{subsec:\thesubsection}{}\penalty0}}

\newcommand{\linksectionold}[2][\DefaultOpt]{\def\DefaultOpt{#2}\section[#1]{\protect\hyperlink{sec:\thesection-\thepage}{#2}\pagetarget{doc:\thesection}}
\addtocontents{toc}{\protect\pagetarget{sec:\thesection-\thepage}{}}}

\newcommand{\sublinksectionold}[2][\DefaultOpt]{\def\DefaultOpt{#2}\subsection[#1]{\protect\hyperlink{subsec:\thesubsection-\thepage}{#2}\pagetarget{doc:\thesubsection}}
\addtocontents{toc}{\protect\pagetarget{subsec:\thesubsection-\thepage}{}\penalty0}}

%\usepackage{sectsty}
%\sectionfont{\clearpage}

%\usepackage{titlesec}
%\newcommand{\subsectionbreak}{\clearpage}

%\usepackage{etoolbox}
%\preto{\subsection}{\ifnum\value{subsection}=0 \else\clearpage\fi}

%\let\stdsubsection\subsection
%\renewcommand\subsection{\clearpage\stdsubsection}
%\let\stdsubsubsection\subsubsection
%\renewcommand\subsubsection{\clearpage\stdsubsubsection}

\begin{document}
	\subfile{parts/general_info}
	\tableofcontents
	\title{История и философия науки\\Конспект лекций}
	\author{Муравцев А.А.\thanks{конспектирует; email: almuravcev@yandex.ru}
	\and
	Шипунова О.Д.\thanks{лектор. Аудиозаписи лекций \href{https://drive.google.com/drive/folders/1iSx2EjJJ98rhPpOsM4xGcJA7-7qitQHM?usp=sharing}{доступны по ссылке}.}
	}
	\maketitle
	
	\fancypagestyle{plain}{%
	\fancyhf{}%
	\fancyhead[L]{\phantom{}\notselectableinacrobat{\pagelink{doc:\thesection}{\leftmark}}}%
	\fancyhead[R]{\phantom{}\notselectableinacrobat{\hyperlink{tocsection.\thesection}{\textcolor{mygray2}{Вернуться к содержанию}}}}%
	\fancyfoot[C]{\phantom{}\notselectableinacrobat{\hyperlink{tocsubsection.\thesubsection}{\thepage}}}
	}
	\pagestyle{plain}
	
	\begin{nohyphen}
	\subfile{parts/2023_11_09}
	\newpage
	\subfile{parts/2023_11_16}
	\newpage
	\subfile{parts/2023_11_23}
	\newpage
	\subfile{parts/2023_11_30}
	\newpage
	\subfile{parts/2023_12_07}
	\newpage
	\subfile{parts/2023_12_14}
	\newpage
	\subfile{parts/2023_12_21}
	\newpage
	\subfile{parts/2024_02_01}
	\newpage
	\subfile{parts/2024_03_04}
	\newpage
	\subfile{parts/books}
	\newpage
	\subfile{parts/exam}
	\newpage
	\subfile{parts/exam_answers}
	\end{nohyphen}
	
\end{document}
